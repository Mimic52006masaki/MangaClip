{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/masaki/Desktop/OriginalApp/MangaClip/components/MangaTable.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\n\ninterface MangaArticle {\n  id: number;\n  originalTitle: string;\n  generatedTitle: string | null;\n  url: string;\n  targetDate: string | null;\n  createdAt: string;\n  updatedAt: string;\n  checked: boolean;\n}\n\nexport default function MangaTable() {\n  const [articles, setArticles] = useState<MangaArticle[]>([]);\n  const [loading, setLoading] = useState(false);\n\n  const fetchArticles = async () => {\n    try {\n      const response = await fetch('/api/scrape/manga');\n      const data = await response.json();\n      if (data.success) {\n        console.log('Fetched articles:', data.articles.length);\n        setArticles(data.articles);\n      }\n    } catch (error) {\n      console.error('Error fetching articles:', error);\n    }\n  };\n\n  const handleScrape = async () => {\n    setLoading(true);\n    try {\n      const response = await fetch('/api/scrape/manga', { method: 'POST' });\n      const data = await response.json();\n      if (data.success) {\n        await fetchArticles(); // Refresh the list\n      }\n    } catch (error) {\n      console.error('Error scraping:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCopy = async (text: string) => {\n    try {\n      await navigator.clipboard.writeText(text);\n      alert('Copied!');\n    } catch (error) {\n      alert('Failed to copy');\n    }\n  };\n\n  const handleDelete = async (id: number) => {\n    if (!confirm('本当に削除しますか？')) return;\n    try {\n      const response = await fetch('/api/scrape/manga', {\n        method: 'DELETE',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ id })\n      });\n      const data = await response.json();\n      if (data.success) {\n        await fetchArticles(); // Refresh the list\n        alert('削除しました');\n      } else {\n        alert('削除失敗: ' + data.error);\n      }\n    } catch (error) {\n      alert('削除失敗');\n    }\n  };\n\n  const handleBulkDelete = async () => {\n    if (!confirm('全ての漫画記事を削除しますか？')) return;\n    try {\n      const response = await fetch('/api/scrape/manga', {\n        method: 'DELETE',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ all: true })\n      });\n      const data = await response.json();\n      if (data.success) {\n        await fetchArticles(); // Refresh the list\n        alert(`${data.deleted}件削除しました`);\n      } else {\n        alert('削除失敗: ' + data.error);\n      }\n    } catch (error) {\n      alert('削除失敗');\n    }\n  };\n\n  useEffect(() => {\n    fetchArticles();\n  }, []);\n\n  // Group by date\n  const groupedArticles = articles.reduce((groups, article) => {\n    if (!article.targetDate) return groups;\n    const date = new Date(article.targetDate).toLocaleDateString('ja-JP');\n    if (!groups[date]) groups[date] = [];\n    groups[date].push(article);\n    return groups;\n  }, {} as Record<string, MangaArticle[]>);\n  console.log('Grouped articles keys:', Object.keys(groupedArticles));\n\n  console.log('Rendering MangaTable');\n  return (\n    <div className=\"p-4\">\n      <h2 className=\"text-2xl font-bold mb-4\">漫画まとめ速報</h2>\n      <div className=\"mb-4 space-x-2\">\n        <button\n          onClick={handleScrape}\n          disabled={loading}\n          className=\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:bg-gray-400\"\n        >\n          {loading ? '取得中...' : '記事取得'}\n        </button>\n        <button\n          onClick={handleBulkDelete}\n          className=\"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600\"\n        >\n          全記事削除\n        </button>\n      </div>\n\n      {Object.keys(groupedArticles).sort((a, b) => new Date(b).getTime() - new Date(a).getTime()).map(date => (\n        <div key={date} className=\"mb-8\">\n          <h3 className=\"text-xl font-semibold mb-2\">{date}</h3>\n          <button\n            onClick={() => {\n              const urls = groupedArticles[date].map(a => a.url).slice(0, 15);\n              console.log('URLs to open:', urls);\n              urls.forEach((url, index) => {\n                console.log(`Opening URL ${index + 1}: ${url}`);\n                setTimeout(() => window.open(url, '_blank'), index * 500);\n              });\n            }}\n            className=\"mb-2 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600\"\n          >\n            URL一括開き\n          </button>\n          <table className=\"w-full border-collapse border border-gray-300\">\n            <thead>\n              <tr className=\"bg-gray-100\">\n                <th className=\"border border-gray-300 px-4 py-2\">時間</th>\n                <th className=\"border border-gray-300 px-4 py-2\">オリジナルタイトル</th>\n                <th className=\"border border-gray-300 px-4 py-2\">URL</th>\n                <th className=\"border border-gray-300 px-4 py-2\">生成タイトル</th>\n                <th className=\"border border-gray-300 px-4 py-2\">操作</th>\n              </tr>\n            </thead>\n            <tbody>\n              {(() => {\n                const sorted = groupedArticles[date].sort((a, b) => {\n                  if (!a.targetDate || !b.targetDate) return 0;\n                  return new Date(a.targetDate).getTime() - new Date(b.targetDate).getTime();\n                });\n                console.log(`Date ${date}: ${sorted.length} articles`);\n                return sorted;\n              })().map(article => (\n                <tr key={article.id}>\n                  <td className=\"border border-gray-300 px-4 py-2\">\n                    {article.targetDate ? new Date(article.targetDate).toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit' }) : ''}\n                  </td>\n                  <td className=\"border border-gray-300 px-4 py-2\">{article.originalTitle}</td>\n                  <td className=\"border border-gray-300 px-4 py-2\">\n                    <a href={article.url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-500 underline\">\n                      {article.url}\n                    </a>\n                  </td>\n                  <td className=\"border border-gray-300 px-4 py-2\">{article.generatedTitle || article.originalTitle}</td>\n                  <td className=\"border border-gray-300 px-4 py-2\">\n                    <button\n                      onClick={() => handleCopy(article.generatedTitle || article.originalTitle)}\n                      className=\"mr-2 px-2 py-1 bg-purple-500 text-white rounded hover:bg-purple-600\"\n                    >\n                      コピー\n                    </button>\n                    <button\n                      onClick={() => handleDelete(article.id)}\n                      className=\"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600\"\n                    >\n                      削除\n                    </button>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      ))}\n    </div>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 357, "column": 0}, "map": {"version":3,"sources":["file:///Users/masaki/Desktop/OriginalApp/MangaClip/app/manga/page.tsx"],"sourcesContent":["'use client';\n\nimport Link from 'next/link';\nimport MangaTable from '@/components/MangaTable';\n\nexport default function MangaPage() {\n  return (\n    <main className=\"min-h-screen p-8\">\n      <div className=\"text-center mb-4\">\n        <Link href=\"/\" className=\"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 mr-4\">\n          ホームに戻る\n        </Link>\n        <Link href=\"/anime\" className=\"px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600\">\n          アニメまとめCHへ\n        </Link>\n      </div>\n      <h1 className=\"text-4xl font-bold text-center mb-8\">漫画まとめ速報</h1>\n      <MangaTable />\n    </main>\n  )\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAKe,SAAS;IACtB,qBACE,qRAAC;QAAK,WAAU;;0BACd,qRAAC;gBAAI,WAAU;;kCACb,qRAAC,8MAAI;wBAAC,MAAK;wBAAI,WAAU;kCAAkE;;;;;;kCAG3F,qRAAC,8MAAI;wBAAC,MAAK;wBAAS,WAAU;kCAAiE;;;;;;;;;;;;0BAIjG,qRAAC;gBAAG,WAAU;0BAAsC;;;;;;0BACpD,qRAAC,2KAAU;;;;;;;;;;;AAGjB"}}]
}